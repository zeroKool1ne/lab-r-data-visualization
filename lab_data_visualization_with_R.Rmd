---
title: "Lab | Data Visualization in R"
output: html_document
date: "2026-01-11"
---

# Lab | Data Visualization in R - 

# ============================================================================
# 1. LOAD DATASET AND LIBRARIES
# ============================================================================

# load libraries
library(ggplot2)
library(dplyr)
library(VIM)

# Superstore Dataset laden
dataset <- read.csv("dataset/Superstore.csv")

# overview
head(dataset)
str(dataset)
summary(dataset)

# ============================================================================
# 2. BOXPLOT
# ============================================================================

# Boxplot 
par(mfrow = c(1, 2))
boxplot(dataset$Sales, 
        main = "Boxplot: Sales Distribution",
        ylab = "Sales",
        col = "lightblue",
        border = "navy")

# Boxplot Profit
boxplot(dataset$Profit, 
        main = "Boxplot: Profit Distribution",
        ylab = "Profit",
        col = "lightgreen",
        border = "darkgreen")

par(mfrow = c(1, 1))

# ============================================================================
# 3. BAR PLOTS - Top 10 Orders with Highest Sales
# ============================================================================

# Top 10 
top_10_sales <- dataset %>%
  arrange(desc(Sales)) %>%
  head(10) %>%
  mutate(Order_ID = factor(Order_ID, levels = Order_ID))

# Bar Plot ggplot2
ggplot(top_10_sales, aes(x = Order_ID, y = Sales)) +
  geom_bar(stat = "identity", fill = "steelblue", border = "navy") +
  ggtitle("Top 10 Orders with Highest Sales Value") +
  xlab("Order ID") +
  ylab("Sales") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# ============================================================================
# 4. HEATMAP - Missing Data Pattern
# ============================================================================


# ============================================================================
# 5. HISTOGRAM - Profit Distribution
# ============================================================================

# ggplot2
ggplot(dataset, aes(x = Profit)) +
  geom_histogram(fill = "coral", 
                 border = "darkred", 
                 bins = 30) +
  ggtitle("Distribution of Profit") +
  xlab("Profit") +
  ylab("Frequency") +
  theme_minimal()

# ============================================================================
# 6. BAR PLOTS FOR AGGREGATED DATA
# ============================================================================

# Total Sales by Category
sales_by_category <- dataset %>%
  group_by(Category) %>%
  summarise(Total_Sales = sum(Sales), .groups = 'drop') %>%
  arrange(desc(Total_Sales))

# Bar Plot: Total Sales by Category
ggplot(sales_by_category, aes(x = Category, y = Total_Sales)) +
  geom_bar(stat = "identity", fill = "steelblue", border = "navy") +
  ggtitle("Total Sales by Category") +
  xlab("Category") +
  ylab("Total Sales") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# ============================================================================
# Profit by Category
profit_by_category <- dataset %>%
  group_by(Category) %>%
  summarise(Total_Profit = sum(Profit), .groups = 'drop') %>%
  arrange(desc(Total_Profit))

# Bar Plot: Profit by Category
ggplot(profit_by_category, aes(x = Category, y = Total_Profit)) +
  geom_bar(stat = "identity", fill = "lightgreen", border = "darkgreen") +
  ggtitle("Total Profit by Category") +
  xlab("Category") +
  ylab("Total Profit") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# ============================================================================
# Summary Statistics
# ============================================================================

print("Sales Summary:")
print(summary(dataset$Sales))

print("Profit Summary:")
print(summary(dataset$Profit))

print("Sales by Category:")
print(sales_by_category)

print("Profit by Category:")
print(profit_by_category)